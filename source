select
    id as event_id,
    --event_time was a timestamp, datetime()converts it's timezone and made it a datetime
    datetime(event_time,'America/New_York') as event_time,
    event_type,
    json_extract_scalar(event_properties, '$.page_path') as page_viewed_path,
    json_extract_scalar(event_properties, '$.path') as click_path,
    json_extract_scalar(event_properties, '$.click_url') as click_url,
    user_id,
    session_id,
    city,
    country,
    dma
from {{ source('amplitude','event') }}
where event_type in ('page viewed','outbound link clicked')
